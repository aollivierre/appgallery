$sigPath = "$env:USERPROFILE\AppData\Roaming\Microsoft\Signatures"; if (Test-Path $sigPath) { $odFolder = (Get-ChildItem -Path "$env:USERPROFILE" -Filter "OneDrive - *" -Directory).FullName; $odPath = if ($odFolder) { Join-Path $odFolder "Documents\OutlookSignatures" } else { $null }; if ($odPath -and (Test-Path $odPath)) { $restoredFiles = Get-ChildItem -Path $sigPath -Recurse -File; if ($restoredFiles.Count -gt 0) { Write-Output "Restored Outlook Signatures detected at $sigPath."; exit 0 } else { exit 1 } } else { exit 1 } } else { exit 1 }