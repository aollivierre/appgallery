$pName="LHC - RICOH MP C3504ex PCL 6";$pIP="10.0.0.47";$dName="RICOH MP C3504ex PCL 6";$infPath=Join-Path -Path $PSScriptRoot -ChildPath "Driver\disk1\oemsetup.inf";$portName="IP_10.0.0.47";$drvExist=Get-PrinterDriver -Name $dName -EA SilentlyContinue;if(!$drvExist){pnputil /add-driver $infPath;Add-PrinterDriver -Name $dName};$portExist=Get-PrinterPort -Name $portName -EA SilentlyContinue;if(!$portExist){Add-PrinterPort -Name $portName -PrinterHostAddress $pIP};$prtExist=Get-Printer -Name $pName -EA SilentlyContinue;if(!$prtExist){Add-Printer -Name $pName -DriverName $dName -PortName $portName}else{Remove-Printer -Name $pName;Add-Printer -Name $pName -DriverName $dName -PortName $portName}